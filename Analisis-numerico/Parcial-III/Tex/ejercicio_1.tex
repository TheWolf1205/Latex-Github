\begin{homeworkProblem}
  Dada la función
  \begin{align*}
    f(x)=x-\frac{1}{x}-2,\quad f:\mathbb{R}^{+}\to \mathbb{R},
  \end{align*}
  se construye el siguiente algoritmo para aproximar la raíz $r=1$:
  \begin{align*}
    x_{n+1}=2-\frac{1}{x_n}.
  \end{align*}
  \begin{enumerate}
    \item Verificar que si $x_0>1$ entonces la sucesión $\{x_{n}\}$ es monótona decreciente y acotada inferiormente por $1$. Concluir que $x_n\to 1$ aunque esta iteración no esta en las hipótesis del teorema del punto fijo. ¿Qué hipótesis no se cumple?
      \begin{solucion}
        Dada la sucesión:
        \begin{align*}
          x_{n+1} = 2 - \frac{1}{x_n},
        \end{align*}
        queremos demostrar que si $x_0 > 1$, entonces $\{x_n\}$ es monótona decreciente y acotada inferiormente por $1$.\\
        Demostramos por inducción que $x_n \geq 1$ para todo $n$:
        \begin{itemize}
          \item El caso base se tiene por hipótesis, ya que $x_0>1$.
          \item Ahora suponga que se tiene para $n$, es decir.\\
            Supongamos que $x_n \geq 1$. Veamos si $x_{n+1} \geq 1$:
            \begin{align*}
              x_{n+1} = 2 - \frac{1}{x_n}.
            \end{align*}
            Como $x_n \geq 1$, se tiene $\frac{1}{x_n} \leq 1$, lo que implica que:
            \begin{align*}
              x_{n+1} = 2 - \frac{1}{x_n} \geq 2 - 1 = 1.
            \end{align*}
            Por lo tanto, la sucesión es acotada inferiormente por $1$.
        \end{itemize}     
        Ahora afirmamos que $x_{n+1} \leq x_n$, ya que:
        \begin{align*}
            2 \leq x_n + \frac{1}{x_n}.
        \end{align*}
        Para todo $x_n>0$, en particular para todo $x_n>1$ (los nuestros) ahora si reordenamos la desigualdad:
        \begin{align*}
          x_{n+1}=2-\frac{1}{x_n}\leq x_n
        \end{align*}
        Por lo tanto, la sucesión es monótona decreciente.\\
        Ahora, para ver la convergencia note que $\{x_n\}$ es monótona decreciente y acotada inferiormente por $1$, por el teorema de monotonía, converge a un límite $L$. Tomando el límite en la ecuación de recurrencia:
        \begin{align*}
          L = 2 - \frac{1}{L}.
        \end{align*}
        Multiplicamos por $L$:
        \begin{align*}
          L^2 - 2L + 1 &= 0,\\
          (L - 1)^2 &= 0 \quad\Rightarrow L = 1.
        \end{align*}
        Por lo tanto, $x_n \to 1$.\\
        Ahora el teorema del punto fijo requiere que la función de iteración sea contractiva en un intervalo alrededor del punto fijo. La derivada de la función de iteración:
        \begin{align*}
          \varphi(x) = 2 - \frac{1}{x}
        \end{align*}
        es
        \begin{align*}
            \varphi'(x) = \frac{1}{x^2}.
        \end{align*}
        Evaluando en $x = 1$:
        \begin{align*}
          \varphi'(1) = 1.
        \end{align*}
        Como $|\varphi'(1)| = 1$, la condición de contractividad ($|\varphi'(x)| < 1 $ en un entorno del punto fijo) no se cumple, por lo que no se puede garantizar la convergencia por el teorema del punto fijo.
      \end{solucion}
    \item Dar un algoritmo para aproximar la raíz de $f$ que converja cuadráticamente.
      \begin{solucion}
        Ahora veamos un algoritmo de convergencia cuadrática que nos permita aproximar la raíz.\\
        Primero note que la raíz tiene multiplicidad 2, pues
        \begin{align*}
          x+\frac{1}{x}-2=&0\\
          x^2-2x+1&=0\\
          (x-1)^2&=0
        \end{align*}
        Entonces, para obtener un algoritmo que converja cuadráticamente a la raíz $x = 1$, podemos usar el \textbf{método de Newton modificado}:
        \begin{align*}
          x_{n+1} = x_n - \frac{f(x_n)f^{\prime}(x_n)}{(f^{\prime}(x_n))^2-f(x_n)f^{\prime\prime}(x_n)}.
        \end{align*}
        Calculamos $f(x) = x + \frac{1}{x} - 2$ y sus derivadas:
        \begin{align*}
          f^{\prime}(x) = 1 - \frac{1}{x^2},\\
          f^{\prime\prime}(x) = \frac{2}{x^{3}}.
        \end{align*}
        Aplicamos la fórmula de Newton:
        \begin{align*}
          x_{n+1} &= x_n - \frac{\left(x_n + \frac{1}{x_n} - 2\right)\left( 1-\frac{1}{x_n^2} \right)}{\left(1 - \frac{1}{x_n^2}\right)^2-\left( x_n-\frac{1}{x_n}-2 \right)\left( \frac{2}{x_n^3} \right)},\\
          &=x_n - \frac{(x_n^2 + 1 - 2x_n) x_n^2 (x_n^2 - 1)}{(x_n^4 - 2x_n^2 + 1) - 2(x_n^2 + 1 - 2x_n)}.
        \end{align*}
        Este método tiene \textbf{convergencia cuadrática}, pues cumple que su raíz es de multiplicidad $2$, $f\in C^2$ para $x>0$, en particular para una vecindad de $1$ y los únicos problemas de divergencia se encuentran directamente en la raíz $1$ y $0$, por lo que no tendremos que preocuparnos por fallos en las iteraciones, así podemos estar seguros de la convergencia cuadrática del método, lo que significa que el error disminuye aproximadamente como el cuadrado del error anterior en cada iteración. 
      \end{solucion}
  \end{enumerate}
\end{homeworkProblem}
